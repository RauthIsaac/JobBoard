<!-- chat-dialog.component.html -->
<div class="chat-container">
  <!-- Enhanced Header -->
  <div class="chat-header">
    <div class="header-info">
      <div class="avatar bot-avatar">
        <mat-icon>smart_toy</mat-icon>
      </div>
      <div class="header-text">
        <h3>AI Job Assistant</h3>
        <span class="status" [class.online]="!isLoading">
          {{ isLoading ? 'Typing...' : 'Online' }}
        </span>
      </div>
    </div>
    <button mat-icon-button class="menu-button">
      <mat-icon>more_vert</mat-icon>
    </button>
  </div>

  <!-- Enhanced Chat Body -->
  <div class="chat-body" #chatBody>
    <!-- Welcome Message -->
    <div class="welcome-section" *ngIf="messages.length <= 1">
      <div class="welcome-avatar">
        <mat-icon>psychology</mat-icon>
      </div>
      <h4>Welcome to AI Job Assistant!</h4>
      <p>How can I help you ?</p>
      
    </div>

    <!-- Messages -->
    <div class="messages-container">
      <div 
        *ngFor="let msg of messages; let i = index; trackBy: trackByIndex" 
        class="message-wrapper"
        [class.user-wrapper]="!msg.isBot"
        [class.bot-wrapper]="msg.isBot">
        
        <!-- Bot Message -->
        <div *ngIf="msg.isBot" class="message-content bot-message">
          <div class="avatar bot-avatar-small">
            <mat-icon>smart_toy</mat-icon>
          </div>
          <div class="message-bubble bot-bubble">
            <div class="message-text" [innerHTML]="formatMessage(msg.content)"></div>
            <div class="message-time">
              {{ msg.timestamp | date:'HH:mm' }}
            </div>
          </div>
        </div>

        <!-- User Message -->
        <div *ngIf="!msg.isBot" class="message-content user-message">
          <div class="message-bubble user-bubble">
            <div class="message-text">{{ msg.content }}</div>
            <div class="message-time">
              {{ msg.timestamp | date:'HH:mm' }}
              <mat-icon class="read-indicator">done_all</mat-icon>
            </div>
          </div>
          <div class="avatar user-avatar-small">
            <mat-icon>person</mat-icon>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Enhanced Loading -->
    <div *ngIf="isLoading" class="message-wrapper bot-wrapper">
      <div class="message-content bot-message">
        <div class="avatar bot-avatar-small">
          <mat-icon>smart_toy</mat-icon>
        </div>
        <div class="message-bubble bot-bubble typing-bubble">
          <div class="typing-indicator">
            <span></span>
            <span></span>
            <span></span>
          </div>
          <div class="message-time">now</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced Footer -->
  <div class="chat-footer">
    <div class="input-container">
      
      <div class="input-wrapper">
        <input 
          type="text" 
          placeholder="Type your job question..." 
          [(ngModel)]="message"
          (keypress)="onKeyPress($event)"
          [disabled]="isLoading"
          class="message-input"
          #messageInput />
        
      </div>
      
      <!-- Send Button with Animation -->
      <button 
        mat-fab 
        color="primary"
        class="send-button"
        (click)="sendMessage()"
        [disabled]="isLoading || !message.trim()">
        <mat-icon [class.rotate]="isLoading">{{ isLoading ? 'hourglass_empty' : 'send' }}</mat-icon>
      </button>
    </div>
    

  </div>
</div>