<!DOCTYPE html>
<html>
<body>
  <div class="notification-container">
    <button class="notification-bell" (click)="toggleDropdown()" title="Notifications">
      <i class="bi bi-bell bell-icon"></i>
      <span class="notification-badge" [class.show]="unreadCount() > 0">
        {{ unreadCount() > 99 ? '99+' : unreadCount() }}
      </span>
    </button>

    <div class="notification-dropdown" [class.show]="isDropdownOpen">
      <div class="dropdown-header">
        <h3 class="dropdown-title">Notifications</h3>
        <div class="header-actions">
          <button class="btn btn-mark-all" (click)="markAllAsRead()" title="Mark all as read">
            <i class="bi bi-check"></i> Mark All
          </button>
          <button class="btn btn-clear" (click)="clearNotifications()" title="Clear all">
            <i class="bi bi-trash"></i> Clear
          </button>
        </div>
      </div>

      <div class="notifications-list" *ngIf="notifications().length; else emptyState">
        <div class="notification-item" *ngFor="let notification of notifications(); let i = index"
             [class.unread]="!notification.isRead">
          <div class="notification-content">
            <p class="notification-message">{{ notification.message }}</p>
            <small class="notification-link" *ngIf="notification.link" (click)="viewNotification(notification.link)">
              View
            </small>
            <div class="notification-meta">
              <span>{{ getTimeDifference(notification.createdAt + 'Z') }}</span>
            </div>
          </div>
          <div class="notification-actions">
            <button class="action-btn btn-read" *ngIf="!notification.isRead"
                    (click)="markAsRead(i)"
                    title="Mark as read">
              <i class="bi bi-check"></i>
            </button>
            <button class="action-btn btn-delete" (click)="deleteNotification(i)"
                    title="Delete">
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </div>
      </div>

      <ng-template #emptyState>
        <div class="empty-state">
          <i class="bi bi-bell-slash empty-icon"></i>
          <p class="empty-message">No notifications yet</p>
          <p class="empty-subtitle">You'll be notified about job updates</p>
        </div>
      </ng-template>

      <div class="reconnect-section" *ngIf="connectionStatus() !== 'Connected'">
        <button class="btn-reconnect" (click)="reconnect()">
          <i class="bi bi-arrow-clockwise"></i> Reconnect
        </button>
      </div>
    </div>
  </div>
</body>
</html>