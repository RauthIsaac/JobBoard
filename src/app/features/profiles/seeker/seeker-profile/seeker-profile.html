<div class="container">
  <mat-card class="profile-card header-card">
    <div class="header-content row">
      <!-- Profile Image Section with Upload/Delete functionality -->
      <div class="profile-image-container col-lg-2 col-md-4 col-sm-12">
        <div class="image-wrapper">
          <img [src]="seekerData().profileImageUrl || getDefaultProfileImage()" 
               [alt]="seekerData().name" 
               class="profile-pic mx-auto">
          
          <!-- Image overlay for actions -->
          <div class="image-overlay" *ngIf="!isUploadingImage()">
            <button mat-icon-button 
                    class="image-action-btn" 
                    [matMenuTriggerFor]="imageMenu"
                    matTooltip="Manage Profile Image">
              <mat-icon>camera_alt</mat-icon>
            </button>
          </div>

          <!-- Image Menu -->
          <mat-menu #imageMenu="matMenu">
            <button mat-menu-item 
                    (click)="openImageFileDialog()" 
                    [disabled]="isUploadingImage()">
              <mat-icon>cloud_upload</mat-icon>
              <span *ngIf="!seekerData().profileImageUrl">Upload Image</span>
              <span *ngIf="seekerData().profileImageUrl">Change Image</span>
            </button>
            
            <button mat-menu-item 
                    (click)="deleteProfileImage()" 
                    *ngIf="seekerData().profileImageUrl"
                    class="delete-action">
              <mat-icon>delete</mat-icon>
              <span>Delete Image</span>
            </button>
          </mat-menu>

          <!-- Upload Progress Indicator for Image -->
          <div *ngIf="isUploadingImage()" class="upload-progress">
            <mat-spinner diameter="40"></mat-spinner>
            <p>Uploading...</p>
          </div>
        </div>

        <!-- Hidden file input for images -->
        <input #imageFileInput 
               type="file" 
               accept="image/jpeg,image/jpg,image/png,image/gif" 
               style="display: none;" 
               (change)="onImageSelected($event)">
      </div>

      <div class="info-details col-lg-5 col-md-8 col-sm-12">
        <h2>{{seekerData().name}}</h2>
        <p class="role">{{seekerData().title}}</p>
        <p class="contact-info"><i class="bi bi-geo-alt me-2"></i> {{seekerData().address}}</p>
        <p class="contact-info"><i class="bi bi-envelope me-2"></i> {{seekerData().email}}</p>
        <p class="contact-info"><i class="bi bi-telephone me-2"></i> {{seekerData().phoneNumber}}</p>
      </div>

      <div class="action-buttons col-lg-3 col-md-12 col-sm-12">
        <button mat-button routerLink="/editSeeker" class="mt-2"><mat-icon class="mx-1">edit</mat-icon> Edit Profile</button>
        
        <!-- Resume Upload Section -->
        <div class="resume-section">
          <!-- Hidden file input -->
          <input #resumeFileInput 
                 type="file" 
                 accept=".pdf,.doc,.docx" 
                 style="display: none;" 
                 (change)="onResumeSelected($event)">
          
          <!-- Upload Button -->
          <button mat-button 
                  (click)="openResumeFileDialog()" 
                  [disabled]="isUploadingResume()"
                  *ngIf="!seekerData().cV_Url">
            <mat-icon>cloud_upload</mat-icon>
            <span *ngIf="!isUploadingResume()">Upload Resume</span>
            <mat-spinner diameter="20" *ngIf="isUploadingResume()"></mat-spinner>
          </button>

          <!-- Resume Management Buttons (when resume exists) -->
          <div *ngIf="seekerData().cV_Url" class="resume-actions">
            <!-- View/Download Button -->
            <button mat-button (click)="downloadResume()" title="Download Resume">
              <mat-icon>download</mat-icon> Download
            </button>
            
            <!-- Delete Button -->
            <button mat-button 
                    (click)="deleteResume()" 
                    color="warn" 
                    title="Delete Resume">
              <mat-icon>delete</mat-icon> Delete
            </button>
          </div>
        </div>
      </div>
    </div> 
  </mat-card>

  <div class="row">
    <div class="left-section col-lg-8 col-md-12 col-sm-12">
      <mat-card class="profile-card summary-card">
        <h3>Professional Summary</h3>
        <p>{{seekerData().summary}}</p>
      </mat-card>

      <mat-card class="profile-card experience-card">
        <h3>Work Experience</h3>
        <div class="experience-item p-3 my-3" *ngFor="let exp of seekerData().seekerExperiences; trackBy: trackByIndex">
          <div class="job-header">
            <div>
              <h4>{{exp.jobTitle}}</h4>
              <p class="company">{{exp.companyName}}</p>
              <p class="location" *ngIf="exp.location"><i class="bi bi-geo-alt me-2"></i> {{exp.location}}</p>
            </div>
            <span class="dates">{{exp.startDate | date:'MMM yyyy'}} - {{exp.endDate ? (exp.endDate | date:'MMM yyyy') : 'Present'}}</span>
          </div>
          <div class="job-description" *ngIf="exp.description">
            <p>{{exp.description}}</p>
          </div>
        </div>
        
        <!-- Show message if no experience -->
        <div *ngIf="!seekerData().seekerExperiences || seekerData().seekerExperiences.length === 0" class="no-data-message">
          <p>No work experience added yet.</p>
        </div>
      </mat-card>

      <mat-card class="profile-card skills-card">
        <h3>Skills & Technologies</h3>
        <div class="tags-container my-3">
          <span class="tech-chip" *ngFor="let skill of seekerData().skillName; trackBy: trackByIndex">{{skill}}</span>
        </div>
        <div *ngIf="!seekerData().skillName || seekerData().skillName.length === 0" class="no-data-message">
          <p>No skills added yet.</p>
        </div>
      </mat-card>

      <mat-card class="profile-card certifications-card">
        <h3><mat-icon>school</mat-icon> Education</h3>
        <div class="experience-item p-3 my-3" *ngFor="let edu of seekerData().seekerEducations; trackBy: trackByIndex">
          <div class="job-header">
            <div>
              <h5>{{edu.educationLevel}} of {{edu.major}} in {{edu.faculty}}</h5>
              <p>{{edu.university}}</p>
              <p *ngIf="edu.gpa"><strong>GPA: </strong> {{edu.gpa}}/4.0 </p>
            </div>
            <p>{{edu.date | date:'MMM yyyy'}} - {{edu.location}}</p>
          </div>
        </div>
        
        <!-- Show message if no education -->
        <div *ngIf="!seekerData().seekerEducations || seekerData().seekerEducations.length === 0" class="no-data-message">
          <p>No education added yet.</p>
        </div>

        <h3 class="my-4"><mat-icon>verified</mat-icon> Certifications</h3>
        <div class="certification-item">
          <div class="info">
            <h5 *ngFor="let cert of seekerData().certificateName; trackBy: trackByIndex">{{cert}}</h5>
          </div>
        </div>
        <div *ngIf="!seekerData().certificateName || seekerData().certificateName.length === 0" class="no-data-message">
          <p>No certificates added yet.</p>
        </div>
        <mat-divider class="my-3"></mat-divider>
      </mat-card>

      <mat-card class="profile-card training-card">
        <h3>Additional Training</h3>
        <ul *ngIf="seekerData().trainingName && seekerData().trainingName.length > 0">
          <li *ngFor="let training of seekerData().trainingName; trackBy: trackByIndex">{{training}}</li>
        </ul>
        <div *ngIf="!seekerData().trainingName || seekerData().trainingName.length === 0" class="no-data-message">
          <p>No training added yet.</p>
        </div>
      </mat-card>
    </div>

    <div class="right-section col-lg-4 col-md-12 col-sm-12">
      <mat-card class="sidebar-card connect-card">
        <h3>Connect</h3>
        <div class=" p-2">
          <div class="mt-2 d-flex">
            <i class="bi bi-linkedin me-3 fs-4"></i>
            <a href="https://www.linkedin.com/" style="text-decoration: none; font-size: large; margin-top: 3px; color: black;">LinkedIn</a>
          </div>
          <div class="mt-2 d-flex">
            <i class="bi bi-github me-3 fs-4"></i> 
            <a href="https://github.com/" style="text-decoration: none; font-size: large; margin-top: 3px; color: black;">GitHub</a>
          </div>
          <div class="mt-2 d-flex">
            <i class="bi bi-link-45deg me-3 fs-4"></i> 
            <a routerLink="/seekerProfile" style="text-decoration: none; font-size: large; margin-top: 3px; color: black;">Portfolio</a>
          </div>
        </div>
      </mat-card>

      <mat-card class="sidebar-card interests-card">
        <h3>Professional Interests</h3>
        <div class="tags-container my-3">
          <span class="tech-chip" *ngFor="let interest of seekerData().interestName; trackBy: trackByIndex">{{interest}}</span>
        </div>
        <div *ngIf="!seekerData().interestName || seekerData().interestName.length === 0" class="no-data-message">
          <p>No interests added yet.</p>
        </div>
      </mat-card>
    </div>
  </div>  
</div>