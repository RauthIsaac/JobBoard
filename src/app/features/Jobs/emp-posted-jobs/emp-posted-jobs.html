<body>
<div class="container my-4">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center page-header">
    <div>
      <h2 class="fw-bold">My Jobs</h2>
      <p class="text-muted">Manage and track your job postings</p>
    </div>
    <div>
      <button class="btn btn-primary" routerLink="/addJob">+ Post New Job</button>
    </div>
  </div>

  <!-- Metrics -->
  <div class="row g-3 mb-4">
    <div class="col-md-4">
      <div class="metrics-card">
        <div class="d-flex justify-content-between">
          <h5>Total Active Jobs</h5>
          <i class="bi bi-suitcase-lg text-primary"></i>
        </div>
        <div class="metrics-number">{{ expiringSoonJobs().totalActiveJobs }}</div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="metrics-card">
        <div class="d-flex justify-content-between">
          <h5>Applications This Month</h5>
          <i class="bi bi-people text-primary"></i>
        </div>
        <div class="metrics-number">{{ expiringSoonJobs().applicationsThisMonth }}</div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="metrics-card">
        <div class="d-flex justify-content-between">
          <h5>Jobs Expiring Soon</h5>
          <i class="bi bi-clock-history text-primary"></i>
        </div>
        <div class="metrics-number">{{ expiringSoonJobs().jobsExpiringSoon }}</div>
      </div>
    </div>
  </div>

  <!-- Search + Filters -->
  <div class="search-filters mb-4">
    <div class="row g-3 align-items-center">
      <div class="d-flex justify-content-around my-3">
        <div class="col-7">
          <input 
            type="text" 
            class="form-control" 
            placeholder="Search jobs by title or keyword..."
            [value]="searchValue()"
            (input)="onSearchChange($event)">
        </div>
      </div>
      <div class="d-flex justify-content-around">
        <div class="col-md-4">
          <strong>Status</strong>
          <select 
            class="form-select mt-2" 
            [value]="selectedStatus()"
            (change)="onStatusChange($event)">
            <option>All Status</option>
            <option value="Active">Active</option>
            <option value="Expired">Expired</option>
            <option value="Filled">Filled</option>
          </select>
        </div>
        <div class="col-md-4">
          <strong>Sort by</strong>
          <select 
            class="form-select mt-2"
            [value]="selectedSort()"
            (change)="onSortChange($event)">
            <option value="PostedDateDesc">Newest First</option>
            <option value="PostedDateAsc">Oldest First</option>
            <option value="ApplicationsCountDesc">Most Applications</option>
          </select>
        </div>
      </div>
      
      <!-- Clear Filters Button -->
      <div class="col-12 text-center mt-3">
        <button class="btn btn-outline-secondary" (click)="clearFilters()">
          <i class="bi bi-x-circle me-2"></i>Clear Filters
        </button>
      </div>
    </div>
  </div>

  <!-- Loading Indicator -->
  <div class="text-center my-4" *ngIf="isLoading()">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2 text-muted">Loading jobs...</p>
  </div>

  <!-- No Results Message -->
  <div class="text-center my-5" *ngIf="!isLoading() && postedJobs().length === 0">
    <i class="bi bi-inbox display-4 text-muted"></i>
    <h4 class="mt-3 text-muted">No jobs found</h4>
    <p class="text-muted">Try adjusting your search criteria or post a new job.</p>
  </div>

  <!-- Job Cards -->
  <div class="row g-3" *ngIf="!isLoading() && postedJobs().length > 0">
    <div class="col-md-6 col-lg-4" *ngFor="let job of postedJobs()">
      <div class="job-card">
        <div class="d-flex justify-content-between align-items-start">
          <h5 class="fw-bold mt-2">{{job.title}}</h5>
          <button class="delete" (click)="deleteJob(job.id, job.title)" [disabled]="isLoading()">
            <i class="bi bi-trash3"></i>
          </button>
        </div>
        <span class="job-status" [ngClass]="{
                        'status-active': job.status === 'Active',
                        'status-filled': job.status === 'Filled',
                        'status-expired': job.status === 'Expired',
                        }">
                        {{ job.status }}
        </span>
        <p class="text-muted small mt-3">
          <i class="bi bi-calendar me-1"></i>Posted: {{job.postedDateFormatted}} â€¢ 
          <i class="bi bi-clock-history ms-1"></i> Expires: {{job.expireDateFormatted}}
        </p>
        <p class="small text-muted">
          <i class="bi bi-people me-1"></i>{{job.applicationsCount}} applications
        </p>
        <span class="tag">{{job.industry}}</span>
        <div class="mt-4 d-flex justify-content-center">
          <button class="btn btn-outline-secondary px-5 me-3" [routerLink]="['/editJob',job.id]">
            <i class="bi bi-pencil-square me-2"></i>Edit
          </button>
          <button class="btn btn-primary px-5"> 
            <i class="bi bi-people me-2"></i> View Apps
          </button>
        </div>
      </div>
    </div>
  </div>

</div>
</body>